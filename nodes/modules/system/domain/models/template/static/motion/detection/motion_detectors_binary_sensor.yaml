template:
  - binary_sensor:
      - name: "Motion Detectors"
        unique_id: "motion_detectors"
        device_class: motion
        state: >
          {% set motion_detection_enabled = is_state('switch.motion_detection_toggle', 'on') %}
          {% set triggered_sensors = states.binary_sensor
          | selectattr('entity_id','contains','motion_detectors_')
          | selectattr('state', 'eq', 'on')
          | list %}
          {{ 'on' if motion_detection_enabled and triggered_sensors | length > 0 else 'off' }}
        icon: >
          {% if is_state('switch.motion_detection_toggle', 'on') %}
            mdi:motion-sensor
          {% else %}
            mdi:motion-sensor-off
          {% endif %}
        attributes:
          autogenerated: true